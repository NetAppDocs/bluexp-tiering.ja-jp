---
sidebar: sidebar 
permalink: concept-cloud-tiering.html 
keywords: cloud tiering, overview, conceptual, value, features, cost, charging, tiering policies, cooling period, fabricpool 
summary: ネットアップのBlueXP階層化サービスは、アクセス頻度の低いデータをオンプレミスのONTAP クラスタからオブジェクトストレージに自動的に階層化することで、データセンターをクラウドに拡張します。これにより、クラスタの貴重なスペースが解放され、アプリケーションレイヤに変更を加えることなく、より多くのワークロードに対応できるようになります。BlueXPの階層化サービスを利用すれば、データセンターのコストを削減し、CAPEXモデルからOPEXモデルに切り替えることができます。 
---
= BlueXPの階層化機能の詳細をご確認ください
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
ネットアップのBlueXP階層化サービスは、アクセス頻度の低いデータをオンプレミスのONTAP クラスタからオブジェクトストレージに自動的に階層化することで、データセンターをクラウドに拡張します。これにより、クラスタの貴重なスペースが解放され、アプリケーションレイヤに変更を加えることなく、より多くのワークロードに対応できるようになります。BlueXPの階層化サービスを利用すれば、データセンターのコストを削減し、CAPEXモデルからOPEXモデルに切り替えることができます。

BlueXP階層化サービスは、_ FabricPool _の機能を活用しています。FabricPool はネットアップデータファブリックのテクノロジで、低コストのオブジェクトストレージへデータを自動で階層化することができます。アクティブな（ホットな）データはローカル階層（オンプレミスの ONTAP アグリゲート）に残り、アクセス頻度の低い（コールド）データはクラウド階層に移動されます。移動されると、 ONTAP のデータ効率は維持されます。

オールSSDアグリゲートを使用するAFF 、FAS 、およびONTAP Select システムでサポートされていたのは、ONTAP 9.8以降で、高性能のSSDに加え、HDDで構成されるアグリゲートからデータを階層化できるようになりました。を参照してください https://docs.netapp.com/us-en/ontap/fabricpool/requirements-concept.html["FabricPool を使用する際の考慮事項と要件"^] を参照してください。

BlueXPの階層化は、シングルノードクラスタ、HA構成のクラスタ、階層化ミラー構成のクラスタ、およびFabricPool ミラーを使用したMetroCluster 構成に対して設定できます。BlueXP階層化ライセンスはすべてのクラスタで共有されます。

https://bluexp.netapp.com/cloud-tiering-service-tco["BlueXP階層化TCO計算ツールを使用して、どれだけのコストを削減できるかを確認できます"^]。



== の機能

BlueXPの階層化サービスでは、自動化、監視、レポート作成、共通の管理インターフェイスを利用できます。

* 自動化により、データのセットアップと管理が容易になります オンプレミスの ONTAP クラスタからクラウドへの階層化
* クラウドプロバイダのデフォルトのストレージクラス/アクセス階層を選択することも、ライフサイクル管理を使用して古い階層化データに対費用効果の高い階層を割り当てることもできます。
* 追加のオブジェクトストアへの接続を作成して、クラスタ内の他のアグリゲートに使用することができます
* UIを使用してオブジェクトストアをアグリゲートにドラッグし、階層化やFabricPool ミラーリングを行うことができます
* 単一のコンソールで、個別に行う必要がありません 複数のクラスタにわたって FabricPool を管理
* レポートには、アクティブなデータと非アクティブなデータの量が表示されます 各クラスタ
* 階層化の健常性ステータスを確認することで、問題を特定して修正できます そのような状況が発生したとき
* Cloud Volumes ONTAP システムを使用している場合は、[クラスタ]ページに表示されるので、ハイブリッドクラウドインフラ内のデータ階層化の全体像を把握できます


BlueXPの階層化機能の詳細については、 https://bluexp.netapp.com/cloud-tiering["BlueXP WebサイトのBlueXP階層化ページをご確認ください"^]。


TIP: Cloud Volumes ONTAP システムは、BlueXP階層化から読み取り専用です。 https://docs.netapp.com/us-en/bluexp-cloud-volumes-ontap/task-tiering.html["BlueXPの作業環境からCloud Volumes ONTAP システムの階層化をセットアップします"^]。



== サポートされているオブジェクトストレージプロバイダ

オンプレミスの ONTAP システムから次のオブジェクトストレージプロバイダにアクセス頻度の低いデータを階層化できます。

* Amazon S3
* Microsoft Azure Blob
* Google クラウドストレージ
* NetApp StorageGRID
* S3互換のオブジェクトストレージ（MinIOなど）


BlueXP階層化ライセンスは、IBM Cloud Object Storageにデータを階層化するクラスタと共有することもできます。FabricPool の設定は、System ManagerまたはONTAP CLIを使用して行う必要がありますが link:task-licensing-cloud-tiering.html#apply-bluexp-tiering-licenses-to-clusters-in-special-configurations["このタイプの構成のライセンスは、BlueXP階層化を使用して取得します。"]


NOTE: NAS ボリュームからパブリッククラウドまたは StorageGRID などのプライベートクラウドにデータを階層化できます。SAN プロトコルがアクセスするデータを階層化する場合は、接続に関する考慮事項に基づいてプライベートクラウドを使用することを推奨します。



=== オブジェクトストレージ階層

ONTAP クラスタは、1つのオブジェクトストアまたは複数のオブジェクトストアにアクセス頻度の低いデータを階層化できます。データの階層化を設定するときに、新しいバケット / コンテナを追加するか、ストレージクラスまたはアクセス階層とともに既存のバケット / コンテナを選択するかを選択できます。

* link:reference-aws-support.html["サポートされている AWS S3 ストレージクラスについて説明します"]
* link:reference-azure-support.html["サポートされる Azure Blob アクセス階層の詳細については、こちらを参照して"]
* link:reference-google-support.html["サポートされている Google Cloud ストレージクラスについて説明します"]


BlueXPの階層化サービスでは、アクセス頻度の低いデータにクラウドプロバイダのデフォルトのストレージクラス/アクセス階層を使用します。ただし、ライフサイクルルールを適用することで、一定の日数が経過した時点でデータがデフォルトのストレージクラスから別のストレージクラスに自動的に移行されるようにすることができます。これにより、コールドデータを低コストのストレージに移動することで、コストを削減できます。


NOTE: StorageGRID または S3 互換のストレージに階層化されたデータのライフサイクルルールは選択できません。



== 価格とライセンス

BlueXP階層化サービスは、従量課金制サブスクリプション、年単位のサブスクリプション、お客様所有のBlueXP階層化ライセンス、またはその組み合わせで購入できます。ライセンスがない場合は、最初のクラスタ用の30日間の無償トライアルを利用できます。

データを StorageGRID に階層化する場合、料金は発生しません。BYOL ライセンスでも PAYGO 登録も必要ありません。

https://bluexp.netapp.com/pricing#tiering["価格設定の詳細を表示します"^]。

BlueXPの階層化ではソースボリュームのストレージ効率化が維持されるため、クラウドプロバイダのオブジェクトストレージのコストは、ONTAP による効率化後の階層化データに対して支払われます（重複排除と圧縮を適用したあとのデータ量が少ない分）。



=== 30 日間の無償トライアルをご利用いただけます

BlueXP階層化ライセンスをお持ちでない場合は、最初のクラスタへの階層化をセットアップすると、BlueXP階層化の30日間無償トライアルが開始されます。30日間の無償トライアルの終了後、BlueXP階層化サービスの料金は、従量課金制サブスクリプション、年間サブスクリプション、BYOLライセンス、またはその組み合わせで支払う必要があります。

無償トライアルが終了し、ライセンスを登録または追加していない場合、ONTAP はコールドデータをオブジェクトストレージに階層化しなくなります。これまで階層化されていたすべてのデータに引き続きアクセスできるため、このデータを読み出して使用できます。取得されると、このデータはクラウドから高パフォーマンス階層に戻されます。



=== 従量課金制のサブスクリプション

BlueXP階層化サービスは、従量課金制モデルで消費量ベースのライセンスを提供します。クラウドプロバイダのマーケットプレイスを通じて登録すると、階層化されたデータに対してGB単位の料金が発生するため、前払い料金は発生しません。クラウドプロバイダから月額料金で請求されます。

無償トライアルを利用されている場合や、お客様が独自のライセンスを使用（ BYOL ）されている場合も、サブスクリプションを設定する必要があります。

* 登録することで、無償トライアルの終了後にサービスが中断されることがなくなります。
+
トライアルが終了すると、階層化したデータの量に応じて1時間ごとに課金されます。

* BYOL ライセンスで許可されている数を超えるデータを階層化した場合、従量課金制サブスクリプションでデータの階層化が続行されます。
+
たとえば、 10TB のライセンスがある場合、 10TB を超える容量はすべて従量課金制サブスクリプションで課金されます。



無償トライアル中や、BlueXPの階層化BYOLライセンスを超えていない場合は、従量課金制サブスクリプションから請求されることはありません。

link:task-licensing-cloud-tiering.html#use-a-bluexp-tiering-paygo-subscription["従量課金制サブスクリプションの設定方法について説明します"]。



=== 年間契約

BlueXP階層化サービスは、アクセス頻度の低いデータをAmazon S3またはAzureに階層化する際に年間契約を提供します。1年、2年、3年の期間が用意されています。

現在、Google Cloudへの階層化では年間契約はサポートされていません。



=== お客様所有のライセンスを使用

ネットアップから* BlueXP階層化*ライセンス（旧称「Cloud Tiering」ライセンス）を購入して、お客様所有のライセンスを使用します。1年、2年、3年のライセンスを購入し、任意の量の階層化容量（最低10TiBから）を指定できます。BYOL BlueXP階層化ライセンスは_floating_licenseで、オンプレミスの複数のONTAP クラスタで使用できます。BlueXP階層化ライセンスで定義した合計階層化容量は、すべてのオンプレミスクラスタで使用できます。

BlueXP階層化ライセンスを購入したら、BlueXPのBlueXPデジタルウォレットを使用してライセンスを追加する必要があります。 link:task-licensing-cloud-tiering.html#use-a-bluexp-tiering-byol-license["BlueXP階層化BYOLライセンスの使用方法を説明します"]。

前述したように、 BYOL ライセンスを購入した場合でも、従量課金制のサブスクリプションを設定することを推奨します。


NOTE: 2021 年 8 月以降、古い * FabricPool * ライセンスが * Cloud Tiering * ライセンスに置き換えられました。 link:task-licensing-cloud-tiering.html#bluexp-tiering-byol-licensing-starting-in-2021["BlueXP階層化ライセンスとFabricPool ライセンスの違いについては、こちらをご覧ください"]。



== BlueXP階層化の仕組み

BlueXP階層化サービスは、ネットアップが管理するサービスです。FabricPool テクノロジを使用して、アクセス頻度の低いコールドデータをオンプレミスのONTAP クラスタからパブリッククラウドやプライベートクラウドのオブジェクトストレージに自動的に階層化します。ONTAP への接続はコネクタから行われます。

次の図は、各コンポーネント間の関係を示しています。

image:diagram_cloud_tiering.png["BlueXP階層化サービスを示すアーキテクチャ図。クラウドプロバイダのコネクタへの接続、ONTAP クラスタへの接続、およびONTAP クラスタとクラウドプロバイダのオブジェクトストレージ間の接続を確立します。アクティブなデータは ONTAP クラスタに格納され、アクセス頻度の低いデータはオブジェクトストレージに格納されます。」"]

BlueXPの階層化機能の概要は次のようになります。

. BlueXPからオンプレミスクラスタを検出します。
. 階層化を設定するには、バケット / コンテナ、ストレージクラスまたはアクセス階層、階層化データのライフサイクルルールなど、オブジェクトストレージに関する詳細を指定します。
. BlueXPでは、オブジェクトストレージプロバイダを使用するようにONTAP が設定され、クラスタ上のアクティブなデータと非アクティブなデータの量が検出されます。
. 階層化するボリュームとそれらのボリュームに適用する階層化ポリシーを選択します。
. ONTAP は、アクセス頻度の低いデータをオブジェクトストアに階層化します。アクセス頻度の低いデータとして扱われるしきい値に達するとすぐにアクセスを開始します（を参照） <<ボリューム階層化ポリシー>>）。
. 階層化されたデータにライフサイクルルールを適用した場合（一部のプロバイダでのみ使用可能）、一定の日数が経過すると、より対費用効果の高い階層に古い階層化データが割り当てられます。




=== ボリューム階層化ポリシー

階層化するボリュームを選択する場合は、各ボリュームに適用するボリューム階層化ポリシーを選択します。階層化ポリシーは、ボリュームのユーザデータブロックをクラウドに移動するタイミングと、移動するかどうかを決定します。

冷却期間 * を調整することもできます。ボリューム内のユーザデータが「コールド」とみなされてオブジェクトストレージに移動されるまでの日数です。階層化ポリシーでクーリング期間を調整できる場合、 ONTAP 9.8 以降では 2 ~ 183 日、 ONTAP の以前のバージョンでは 2 ~ 63 日の有効値を使用することを推奨します。ベストプラクティスは 2 ~ 63 です。

ポリシーなし（なし）:: パフォーマンス階層内のボリュームのデータを保持し、クラウド階層に移動されないようにします。
コールドスナップショット（ Snapshot のみ）:: ONTAP は、アクティブなファイルシステムと共有されていないボリューム内のコールドスナップショットブロックをオブジェクトストレージに階層化します。読み取られると、クラウド階層のコールドデータブロックはホットになり、パフォーマンス階層に移動します。
+
--
データが階層化されるのは、アグリゲートの容量が 50% に達し、データがクーリング期間に達した場合のみです。デフォルトのクーリング日数は 2 ですが、この数は調整できます。


NOTE: 再加熱されたデータは、スペースがある場合にのみパフォーマンス階層に書き戻されます。パフォーマンス階層の容量が 70% を超えている場合、ブロックはクラウド階層から引き続きアクセスされます。

--
コールドユーザデータとスナップショット（自動）:: ONTAP は、ボリューム内のすべてのコールドブロックをオブジェクトストレージに階層化します（メタデータは含まれません）。コールドデータには、 Snapshot コピーだけでなく、アクティブなファイルシステムのコールドユーザデータも含まれます。
+
--
ランダムリードで読み取られた場合、クラウド階層のコールドデータブロックはホットになり、パフォーマンス階層に移動されます。インデックススキャンやウィルス対策スキャンに関連するようなシーケンシャルリードで読み取られた場合、クラウド階層のコールドデータブロックはコールドのままで、パフォーマンス階層には書き込まれません。このポリシーは ONTAP 9.4 以降で使用できます。

データが階層化されるのは、アグリゲートの容量が 50% に達し、データがクーリング期間に達した場合のみです。デフォルトのクーリング日数は 31 日ですが、この数は調整できます。


NOTE: 再加熱されたデータは、スペースがある場合にのみパフォーマンス階層に書き戻されます。パフォーマンス階層の容量が 70% を超えている場合、ブロックはクラウド階層から引き続きアクセスされます。

--
すべてのユーザデータ（すべて）:: すべてのデータ（メタデータを除く）はすぐにコールドとしてマークされ、オブジェクトストレージにできるだけ早く階層化されます。ボリューム内の新しいブロックがコールドになるまで、 48 時間待つ必要はありません。「すべて」のポリシーが設定される前のボリュームにあるブロックは、コールドになるまで 48 時間かかります。
+
--
読み取られた場合、クラウド階層のコールドデータブロックはコールドのままで、パフォーマンス階層に書き戻されません。このポリシーは ONTAP 9.6 以降で使用できます。

この階層化ポリシーを選択する前に、次の点を考慮してください。

* データを階層化することで、ストレージ効率が即座に低下します（インラインのみ）。
* このポリシーは、ボリュームのコールドデータが変更されないことに確信がある場合にのみ使用してください。
* オブジェクトストレージがトランザクションではないため、変更されるとフラグメント化の効果が大きくなります。
* データ保護関係のソースボリュームに「すべて」の階層化ポリシーを割り当てる前に、 SnapMirror 転送の影響を考慮してください。
+
データはすぐに階層化されるため、 SnapMirror はパフォーマンス階層ではなくクラウド階層からデータを読み取ります。そのため、 SnapMirror 処理が遅くなります。別の階層化ポリシーを使用している場合でも、 SnapMirror 処理の速度が遅くなる可能性があります。

* BlueXPのバックアップとリカバリも、階層化ポリシーが設定されたボリュームの影響を受けます。 https://docs.netapp.com/us-en/bluexp-backup-recovery/concept-ontap-backup-to-cloud.html#fabricpool-tiering-policy-considerations["BlueXPのバックアップとリカバリでの階層化ポリシーに関する考慮事項を参照してください"^]。


--
すべての DP ユーザデータ（バックアップ）:: データ保護ボリューム上のすべてのデータ（メタデータを除く）は、すぐにクラウド階層に移動されます。読み取られた場合、クラウド階層のコールドデータブロックはコールドのままで、パフォーマンス階層に書き戻されません（ ONTAP 9.4 以降）。
+
--

NOTE: このポリシーは ONTAP 9.5 以前で使用できます。ONTAP 9.6 以降では、「すべて * 」の階層化ポリシーに置き換えられています。

--

