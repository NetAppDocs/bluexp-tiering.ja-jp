---
sidebar: sidebar 
permalink: task-managing-object-storage.html 
keywords: object storage, mirror object storage, create object storage, remove object storage, swap object storage, display object storage 
summary: データを特定のオブジェクトストレージに階層化するようにオンプレミスのONTAP クラスタを設定したら、追加のオブジェクトストレージタスクを実行できます。新しいオブジェクトストレージの追加、セカンダリオブジェクトストレージへの階層化データのミラーリング、プライマリオブジェクトとミラーオブジェクトのストレージのスワップ、アグリゲートからのミラーオブジェクトストアの削除などが可能です。 
---
= データの階層化に使用するオブジェクトストレージの管理
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
データを特定のオブジェクトストレージに階層化するようにオンプレミスのONTAP クラスタを設定したら、追加のオブジェクトストレージタスクを実行できます。新しいオブジェクトストレージの追加、セカンダリオブジェクトストレージへの階層化データのミラーリング、プライマリオブジェクトとミラーオブジェクトのストレージのスワップ、アグリゲートからのミラーオブジェクトストアの削除などが可能です。



== クラスタに設定されているオブジェクトストアの表示

クラスタに対して設定されているすべてのオブジェクトストアと、それらが接続されているアグリゲートを表示することができます。Cloud Tiering は、各クラスタにこの情報を提供します。

.手順
. クラスタダッシュボード*で、クラスタのメニューアイコンをクリックし、*オブジェクトストア情報*を選択します。
. オブジェクトストアの詳細を確認します。
+
次の例では、Amazon S3とAzure Blobオブジェクトストアがクラスタ上の別のアグリゲートに接続されています。

+
image:screenshot_tiering_object_store_view.png["オブジェクトのストレージ情報、合計使用容量、オブジェクトストアに接続されているアグリゲート、オブジェクトストアの名前、および詳細情報を示すスクリーンショット。"]





== 新しいオブジェクトストアを追加しています

クラスタ内のアグリゲートに使用できる新しいオブジェクトストアを追加できます。作成したら、アグリゲートに接続できます。

.手順
. クラスタダッシュボード*で、クラスタのメニューアイコンをクリックし、*オブジェクトストア情報*を選択します。
. [オブジェクトストア情報]ページで、[*新規オブジェクトストアの作成*]をクリックします。
+
image:screenshot_tiering_object_store_create_button.png["新しいオブジェクトストアを作成するためのCreate New Object Storeボタンを示すスクリーンショット。"]

+
オブジェクトストアウィザードが起動します。次の例は、Amazon S3にオブジェクトストアを作成する方法を示しています。

. *オブジェクトストレージ名の定義*：このオブジェクトストレージの名前を入力します。このクラスタのアグリゲートで使用する可能性のある他のオブジェクトストレージから一意である必要があります。
. *プロバイダの選択*：「Amazon Web Services *」などのプロバイダを選択し、「* Continue *」をクリックします。
. Create Object Storage *ページで次の手順を実行します。
+
.. * S3 Bucket *：新しいS3バケットを追加するか、prefix_fabric-pool_で始まる既存のS3バケットを選択します。次に、バケットへのアクセスを提供するAWSアカウントIDを入力し、バケットのリージョンを選択して* Continue *をクリックします。
+
コネクタの IAM ポリシーではインスタンスが指定したプレフィックスのバケットに対して S3 処理を実行できるため、 _fabric-pool_prefix が必要です。たとえば、 S3 バケット _fabric-pool-AFF1_、 AFF1 はクラスタの名前です。

.. * ストレージクラスのライフサイクル * ： Cloud Tiering は、階層化されたデータのライフサイクルの移行を管理します。データは _Standard_class から始まりますが、データを特定の日数後に別のクラスに移動するルールを作成できます。
+
階層化データの移行先となる S3 ストレージクラスと、データを移動するまでの日数を選択し、 * Continue * をクリックします。たとえば、次のスクリーンショットは、オブジェクトストレージで 45 日後に階層化データが _Standard_class から _Standard-IA_class に移動されたことを示しています。

+
「 * このストレージクラスにデータを保持する」を選択した場合、データは _Standard_storage クラスに残り、ルールは適用されません。 link:reference-aws-support.html["「サポートされているストレージクラス」を参照"^]。

+
image:screenshot_tiering_lifecycle_selection_aws.png["特定の日数が経過したあとにデータを移動する別のストレージクラスの選択方法を示すスクリーンショット。"]

+
ライフサイクルルールは、選択したバケット内のすべてのオブジェクトに適用されます。

.. * クレデンシャル * ：必要な S3 権限を持つ IAM ユーザのアクセスキー ID とシークレットキーを入力し、 * Continue * をクリックします。
+
IAM ユーザは、「 * S3 Bucket * 」ページで選択または作成したバケットと同じ AWS アカウントに属している必要があります。階層化のアクティブ化に関するセクションで、必要な権限を確認してください。

.. * クラスタネットワーク * ： ONTAP がオブジェクトストレージへの接続に使用する IPspace を選択し、「 * 続行」をクリックします。
+
正しい IPspace を選択すると、 Cloud Tiering を使用して、 ONTAP からクラウドプロバイダのオブジェクトストレージへの接続をセットアップできます。





オブジェクトストアが作成されます。

これで、クラスタ内のアグリゲートにオブジェクトストアを接続できるようになります。



== ミラーリング用に2つ目のオブジェクトストアをアグリゲートに接続しています

2つ目のオブジェクトストアをアグリゲートに接続してFabricPool ミラーを作成し、オブジェクトストアをレプリケートできます。アグリゲートにオブジェクトストアがすでに1つ接続されている必要があります。

.手順
. [*クラスタダッシュボード*]で、選択したクラスタの[詳細設定*]をクリックします。
+
image:screenshot_tiering_advanced_setup_button.png["クラスタのAdvanced Setupボタンを示すスクリーンショット。"]

. 詳細設定ページで、使用するオブジェクトストアをミラーオブジェクトストアの場所にドラッグします。
+
image:screenshot_tiering_mirror_config.png["2つ目のオブジェクトストアをアグリゲートにドラッグして階層化ミラーを作成する方法を示すスクリーンショット。"]

. オブジェクトストアの接続ダイアログで、*接続*をクリックし、2つ目のオブジェクトストアをアグリゲートに接続します。
+
image:screenshot_tiering_mirror_config_complete.png["アグリゲートに接続された2つ目のオブジェクトストアを示すスクリーンショット。"]





== プライマリオブジェクトストアとミラーオブジェクトストアを交換しています

アグリゲートのプライマリオブジェクトストアとミラーオブジェクトストアをスワップできます。オブジェクトストアミラーがプライマリになり、元のプライマリがミラーになります。

.手順
. [*クラスタダッシュボード*]で、選択したクラスタの[詳細設定*]をクリックします。
+
image:screenshot_tiering_advanced_setup_button.png["クラスタのAdvanced Setupボタンを示すスクリーンショット。"]

. Advanced Setupページで、アグリゲートのメニューアイコンをクリックし、* Swap Destinations *を選択します。
+
image:screenshot_tiering_mirror_swap.png["アグリゲートのSwap Destinationオプションを示すスクリーンショット"]

. ダイアログボックスでアクションを承認し、プライマリオブジェクトストアとミラーオブジェクトストアがスワップされます。




== アグリゲートからのミラーオブジェクトストアの削除

追加のオブジェクトストアにレプリケートする必要がなくなった場合は、FabricPool ミラーを削除できます。

.手順
. [*クラスタダッシュボード*]で、選択したクラスタの[詳細設定*]をクリックします。
+
image:screenshot_tiering_advanced_setup_button.png["クラスタのAdvanced Setupボタンを示すスクリーンショット。"]

. Advanced Setupページで、アグリゲートのメニューアイコンをクリックし、* Unmirror Object Store *を選択します。
+
image:screenshot_tiering_mirror_delete.png["アグリゲートのUnmirror Object Storeオプションを示すスクリーンショット。"]



ミラーオブジェクトストアがアグリゲートから削除され、階層化データはレプリケートされなくなります。



== 階層化されたデータを別のクラウドプロバイダに移行する

Cloud Tieringを使用すると、階層化されたデータを別のクラウドプロバイダに簡単に移行できます。たとえば、Amazon S3からAzure Blobに移動する場合は、上記の手順を次の順序で実行できます。

. Azure Blobオブジェクトストアを追加
. この新しいオブジェクトストアをミラーとして既存のアグリゲートに接続します。
. プライマリオブジェクトストアとミラーオブジェクトストアを入れ替えます。
. Amazon S3オブジェクトストアのミラーリングを解除します。

